"0","plot_merit <- kidiq %>%"
"0","  mutate("
"0","    mom_hs_label = factor(mom_hs, labels = c(""No HS diploma"", ""HS diploma"")),"
"0","    ability_level = case_when("
"0","      mom_iq <= quantile(mom_iq, 0.25, na.rm = TRUE) ~ ""Low ability"","
"0","      mom_iq <= quantile(mom_iq, 0.75, na.rm = TRUE) ~ ""Medium ability"","
"0","      TRUE ~ ""High ability"""
"0","    ),"
"0","    outcome_level = case_when("
"0","      kid_score <= quantile(kid_score, 0.25, na.rm = TRUE) ~ ""Low outcome"","
"0","      kid_score <= quantile(kid_score, 0.75, na.rm = TRUE) ~ ""Medium outcome"","
"0","      TRUE ~ ""High outcome"""
"0","    ),"
"0","    surprising_case = case_when("
"0","      ability_level == ""High ability"" & outcome_level == ""Low outcome"" ~ "
"0","        ""High ability, low outcome"","
"0","      ability_level == ""Low ability""  & outcome_level == ""High outcome"" ~"
"0","        ""Low ability, high outcome"","
"0","      TRUE ~ NA_character_"
"0","    )"
"0","  )"
"0",""
"0","ggplot(plot_merit, aes(mom_iq, kid_score)) +"
"0","  stat_bin2d(bins = 24) +"
"0","  scale_fill_viridis_c(name = ""Cases"", option = ""C"", direction = -1) +"
"0","  geom_smooth(method = ""lm"", se = FALSE, linetype = ""dashed"","
"0","              color = ""white"", linewidth = 1) +"
"0","  geom_point("
"0","    data = dplyr::filter(plot_merit, !is.na(surprising_case)),"
"0","    aes(color = surprising_case),"
"0","    size = 2.6"
"0","  ) +"
"0","  scale_color_manual("
"0","    values = c(""High ability, low outcome"" = ""#E69F00"","
"0","               ""Low ability, high outcome"" = ""#56B4E9""),"
"0","    name = ""Surprising cases"""
"0","  ) +"
"0","  facet_wrap(~ mom_hs_label, nrow = 1) +"
"0","  coord_cartesian(xlim = c(75, 135), ylim = c(40, 120)) +"
"0","  labs("
"0","    title = ""Is Merit Enough?"","
"0","    subtitle = ""Tiles show where most cases sit; dashed lines show the IQ→score trend. "
"0","    Highlighted dots mark exceptions where merit alone didn’t predict outcomes."","
"0","    x = ""Mother’s IQ (ability proxy)"","
"0","    y = ""Child’s test score"","
"0","    caption = ""Data: NLSY (Gelman & Hill, 2007)"""
"0","  ) +"
"0","  theme_minimal(base_size = 12) +"
"0","  theme("
"0","    legend.position = ""bottom"","
"0","    legend.title = element_text(face = ""bold""),"
"0","    strip.text = element_text(face = ""bold""),"
"0","    plot.title = element_text(face = ""bold""),"
"0","    panel.grid.minor = element_blank(),"
"0","    panel.grid.major.x = element_blank(),"
"0","    plot.margin = margin(10, 20, 10, 20)"
"0","  )"
