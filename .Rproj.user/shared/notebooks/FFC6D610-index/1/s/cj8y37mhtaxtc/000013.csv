"0","plot_iq <- kidiq %>%"
"0","  mutate("
"0","    family_advantage = case_when("
"0","      mom_hs == 0 & mom_work <= 2 ~ ""Low advantage"","
"0","      mom_hs == 0 & mom_work >  2 ~ ""Mixed advantage"","
"0","      mom_hs == 1 & mom_work <= 2 ~ ""Mixed advantage"","
"0","      mom_hs == 1 & mom_work >  2 ~ ""High advantage"","
"0","      TRUE ~ NA_character_"
"0","    ),"
"0","    iq_group = case_when("
"0","      mom_iq <= quantile(mom_iq, 0.33, na.rm = TRUE) ~ ""Lower IQ Group"","
"0","      mom_iq <= quantile(mom_iq, 0.67, na.rm = TRUE) ~ ""Middle IQ Group"","
"0","      TRUE ~ ""Higher IQ Group"""
"0","    ),"
"0","    family_advantage = factor(family_advantage,"
"0","                              levels = c(""Low advantage"",""Mixed advantage"",""High advantage"")),"
"0","    iq_group = factor(iq_group,"
"0","                      levels = c(""Lower IQ Group"",""Middle IQ Group"",""Higher IQ Group""))"
"0","  ) %>%"
"0","  filter(!is.na(family_advantage), !is.na(iq_group)) %>%"
"0","  "
"0","  ggplot(aes(x = family_advantage, y = kid_score, fill = family_advantage)) +"
"0","  geom_violin(trim = FALSE, alpha = 0.6, width = 0.8, color = NA) +"
"0","  stat_summary(fun = median, geom = ""crossbar"", width = 0.5, color = ""black"", fatten = 1) +"
"0","  geom_jitter(width = 0.10, height = 0, alpha = 0.25, size = 1.2, color = ""black"", show.legend = FALSE) +"
"0","  facet_wrap(~ iq_group, nrow = 1) +"
"0","  scale_fill_brewer(palette = ""Set2"", guide = ""none"") +"
"0","  scale_x_discrete(labels = c(""Low advantage""=""Low"",""Mixed advantage""=""Mixed"",""High advantage""=""High"")) +"
"0","  labs("
"0","    title = ""Child Scores by Family Background and Maternal IQ"","
"0","    subtitle = ""Higher family advantage leads to higher scores even within the same IQ groups."","
"0","    x = ""Family Advantage Level"","
"0","    y = ""Child's Test Score"","
"0","    caption = ""Data: NLSY (Gelman & Hill, 2007)"""
"0","  ) +"
"0","  theme_minimal(base_size = 13) +"
"0","  theme("
"0","    legend.position = ""none"","
"0","    plot.title = element_text(face = ""bold"", size = 16),"
"0","    strip.text = element_text(face = ""bold"", size = 11),"
"0","    panel.grid.major.x = element_blank()"
"0","  )"
"0",""
"0","print(plot_iq)"
